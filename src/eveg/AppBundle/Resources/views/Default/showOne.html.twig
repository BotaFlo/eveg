{# src/eveg/AppBundle/Resources/views/Default/viewOne.html.twig #}

{% extends "::layout.html.twig" %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/fancytree/skin-win8/ui.fancytree.min.css') }}" type="text/css" />
	{{ parent() }}
{% endblock %}

{% block title %}
	{% if syntaxon is defined %}
		{{ syntaxon.syntaxonName }} | {{ parent() }}
	{% endif %}
	{% if multipleSyntaxon is defined %}
		Plusieurs résultats | {{ parent() }}
	{% endif %}
{% endblock %}

{% block body %}

	{{ parent() }}


	{% if redirectionSyntaxon is defined %}
		<p>Vous avez été redirigé vers le syntaxon retenu pour votre recherche concernant "<span class="{{ redirectionSyntaxon.level }}-text">{{ redirectionSyntaxon.syntaxon }}</span>".</p>
	{% endif %}

	{% if redirectionMultipleSyntaxon is defined %}
		<p>Plusieurs syntaxons correpondent à votre recherche concernant "<span class="{{ redirectionMultipleSyntaxon.level }}-text">{{ redirectionMultipleSyntaxon.syntaxon }}</span>".</p>
	{% endif %}

	{% if redirectionFromSynonym is defined %}
		<p>Vous avez été redirigé vers le syntaxon retenu pour votre recherche concernant "<span class="{{ redirectionFromSynonym.level }}-text">{{ redirectionFromSynonym.syntaxon }}</span></p>
	{% endif %}

	{% if syntaxon is defined %}
		{#{{ dump(syntaxon) }}#}
		{#{{ dump(synonyms) }}#}
	{% endif %}

	{% if multipleSyntaxon is defined %}
		{#{{ dump(multipleSyntaxon) }}#}
	{% endif %}

	{% if allParents is defined %}
		{#{{ dump(allParents) }}#}
	{% endif %}

	{% if syntaxon is defined %}

		{# Flashbags #}
		{% for type, messages in app.session.flashBag.all %}
		    {% for message in messages %}
		        {%if type == 'error'%} {% set type = 'danger' %} {%endif%}
		        <div class="alert alert-{{ type }} alert-dismissible">
		        	<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		            {{ message|raw }}
		        </div>
		    {% endfor %}
		{% endfor %}

		{# SearchBar #}
		<div class="row">
			<div class="col-md-4 colPanelOptions hidden-xs hidden-sm">
				<div class="panel panel-default panelOptionsShowOne">
					<div class="panel-body">
						{% set depFrFilterActive = app.session.get("depFrFilter") %}
						{% if (depFrFilterActive is defined) and (
								depFrFilterActive is not empty
								and (depFrFilterActive != "[]")
								and (depFrFilterActive != "")
								and (depFrFilterActive != null)
						) %}
							{% set depFrFilterIsActive = 'active' %}
							{% set depFrFilterTooltipTitle = "Filtrer eVeg par département (actif)" %}
						{% else %}
							{% set depFrFilterIsActive = '' %}
							{% set depFrFilterTooltipTitle = "Filtrer eVeg par département" %}
						{% endif %}
						<div class="icon-first {{ depFrFilterIsActive }}" data-toggle="modal" data-tooltip="tooltip" data-placement="bottom" data-target="#modalDepFilter" title="{{ depFrFilterTooltipTitle }}">
							<span class="glyphicon glyphicon-filter" aria-hidden="true"></span>
						</div>
						<div class="icon-middle" data-tooltip="tooltip" data-placement="bottom" title="Signaler un problème, une erreur ou faire un commentaire à propos de cette fiche.">
							<span class="glyphicon glyphicon-bell" aria-hidden="true"></span>
						</div>
						<div class="icon-middle" data-tooltip="tooltip" data-placement="bottom" title="Comparer avec un autre syntaxon.">
							<span class="glyphicon glyphicon-adjust" aria-hidden="true"></span>
						</div>
						<div class="icon-last" data-tooltip="tooltip" data-placement="bottom" title="Télécharger la fiche en Pdf.">
							<span class="glyphicon glyphicon-file" aria-hidden="true"></span>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-8">
				{# Searchbox #}
				<div class="row searchRow">
					<div class="right-inner-addon">
						<i class="searchIcon glyphicon glyphicon-refresh glyphicon-refresh-animate"></i>
						<span class="badge-addon badge">X</span>
						<input type="text" class="form-control searchbox" name="term" id ="searchbox" placeholder="Rechercher une végétation">
					</div>
				</div>
			</div>
		</div>

		<div class="row appShowRow">

			<div class="col-md-4 hidden-xs hidden-sm" id="divTree">
				<div>
					
				</div>
				<i class="loadTreeIcon glyphicon glyphicon-refresh glyphicon-refresh-animate"></i>
			</div>

			{# show data #}
			<div class="col-md-8" id="showOneResult">

				{# Header #}
				<div class="row viewHeader-{{ syntaxon.level }}">
					<h1>{{ syntaxon.syntaxonName }} <span class="viewHeaderAuthor">{{ syntaxon.syntaxonAuthor }}</span></h1>
					<h2>{{syntaxon.commonName}}</h2>
				</div>

				{# Breadcrumb #}
				<div class="row flexBreadcrumb hidden-xs hidden-sm">
						{% for syntaxon in allParents %}
							{% if syntaxon.level != 'HAB' %}
								<div class="flexBreadcrumbItem"><a href="{{ path('eveg_show_one', {'id': syntaxon.id}) }}" class="{{ syntaxon.level }}-text">{{ syntaxon.syntaxon }}</a></div>

								{% if not loop.last %}
									<span class="breadcrumbSeparator">/</span>
								{% endif %}
							{% endif %}
						{% endfor %}
				</div>

				{# Breadcrumb for xm & xs views#}
				<div class="row hidden-lg hidden-md">
					{% for syntaxon in allParents %}
						{% if syntaxon.level != 'HAB' %}
								<a href="{{ path('eveg_show_one', {'id': syntaxon.id}) }}" class="{{ syntaxon.level }}-text {{ syntaxon.level }}-indent">{{ syntaxon.syntaxon }}</a><br />
						{% endif %}
					{% endfor %}
				</div>

				{# Data #}
				<div class="row">
					<div class="col-md-8 viewLeft">

						{# Synonyms #}
						{% if synonyms is defined %}
							<div class="panel panel-default">
								<div class="panel-heading panelSynonymsHeader">Synonymes{% if synonyms is empty %} : aucun synonyme trouvé{% endif %}<span class="synonymsShowAll pull-right">Afficher tout</span></div>
								<ul class="list-group">
									{% for synonym in synonyms %}
										<li class="list-group-item synonymBox">
											{{ synonymType(synonym.level)|raw }}
											<a href="{{ path('eveg_show_one', {'id': synonym.id}) }}">
												{{ synonym.syntaxon }}
											</a>
										</li>
									{% endfor %}
								</ul>
							</div> <!-- ./ panel -->
						{% endif %}
						<p>

						{# Ecological specifications #}
						<div class="panel panel-default">
							<div class="panel-heading">Caractéristiques écologiques</div>
							<div class="panel-body">
								Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
							</div>
						</div>

						{# Floristic cortege #}
						<div class="panel panel-default">
							<div class="panel-heading">Cortège floristique</div>
							<div class="panel-body">
								Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
							</div>
						</div>

						{# Resources #}
						<div class="panel panel-default">
							<div class="panel-heading">Ressources</div>
							<div class="panel-body">
								Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
							</div>
						</div>

						{# Bibliography #}
						<div class="panel panel-default">
							<div class="panel-heading">Bibliographie</div>
							<div class="panel-body">
								Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
							</div>
						</div>

					</div> <!-- ./viewLeft -->

					<div class="col-md-4 viewRight">
						<div class="panel panel-default">
							<div class="panel-heading">Répartition</div>
							<div class="panel-body">
								<div id="mapDepFr"></div>
								<div id="mapDepFrHoverLegend">Répartition par département en France métropolitaine</div>
								<div id="mapDepFrToggleLegend">Légende</div>
								<div id="mapDepFrLegend"></div>
							</div>
						</div>
					</div> <!-- ./viewRight -->
				</div> <!-- ./row -->
			</div> <!-- ./col-md-8 -->
		</div>

		<!-- MODALS -->
			<!-- Department filter modal view -->
			<div class="modal fade" id="modalDepFilter" tabindex="-1" role="dialog" aria-labelledby="modalDepFilter">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="modalDepFilter">Filter eVeg par départements</h4>
						</div>
						<div name="depFrFilter" class="modal-body">
							<form action="{{ path('eveg_depFr_filter') }}" method="POST">
								<div class="row">
									<div class="col-md-4">
										<input class="cbFrFilter" type="checkbox" name="_01" value="_01">(01) Ain<br>
										<input class="cbFrFilter" type="checkbox" name="_02" value="_02">(02) Aisne<br>
										<input class="cbFrFilter" type="checkbox" name="_03" value="_03">(03) Allier<br>
										<input class="cbFrFilter" type="checkbox" name="_04" value="_04">(04) Alpes de Haute-Provence<br>
										<input class="cbFrFilter" type="checkbox" name="_05" value="_05">(05) Hautes-Alpes<br>
										<input class="cbFrFilter" type="checkbox" name="_06" value="_06">(06) Alpes-Maritimes<br>
										<input class="cbFrFilter" type="checkbox" name="_07" value="_07">(07) Ardèche<br>
										<input class="cbFrFilter" type="checkbox" name="_08" value="_08">(08) Ardennes<br>
										<input class="cbFrFilter" type="checkbox" name="_09" value="_09">(09) Ariège<br>
										<input class="cbFrFilter" type="checkbox" name="_10" value="_10">(10) Aube<br>
										<input class="cbFrFilter" type="checkbox" name="_11" value="_11">(11) Aude<br>
										<input class="cbFrFilter" type="checkbox" name="_12" value="_12">(12) Aveyron<br>
										<input class="cbFrFilter" type="checkbox" name="_13" value="_13">(13) Bouches du Rhône<br>
										<input class="cbFrFilter" type="checkbox" name="_14" value="_14">(14) Calvados<br>
										<input class="cbFrFilter" type="checkbox" name="_15" value="_15">(15) Cantal<br>
										<input class="cbFrFilter" type="checkbox" name="_16" value="_16">(16) Charente<br>
										<input class="cbFrFilter" type="checkbox" name="_17" value="_17">(17) Charente Maritime<br>
										<input class="cbFrFilter" type="checkbox" name="_18" value="_18">(18) Cher<br>
										<input class="cbFrFilter" type="checkbox" name="_19" value="_19">(19) Corrèze<br>
										<input class="cbFrFilter" type="checkbox" name="_20" value="_20">(20) Corse du Sud + Haute Corse<br>
										<input class="cbFrFilter" type="checkbox" name="_21" value="_21">(21) Côte d'Or<br>
										<input class="cbFrFilter" type="checkbox" name="_22" value="_22">(22) Côtes d'Armor<br>
										<input class="cbFrFilter" type="checkbox" name="_23" value="_23">(23) Creuse<br>
										<input class="cbFrFilter" type="checkbox" name="_24" value="_24">(24) Dordogne<br>
										<input class="cbFrFilter" type="checkbox" name="_25" value="_25">(25) Doubs<br>
										<input class="cbFrFilter" type="checkbox" name="_26" value="_26">(26) Drôme<br>
										<input class="cbFrFilter" type="checkbox" name="_27" value="_27">(27) Eure<br>
										<input class="cbFrFilter" type="checkbox" name="_28" value="_28">(28) Eure-et-Loir<br>
										<input class="cbFrFilter" type="checkbox" name="_29" value="_29">(29) Finistère<br>
										<input class="cbFrFilter" type="checkbox" name="_30" value="_30">(30) Gard<br>
										<input class="cbFrFilter" type="checkbox" name="_31" value="_31">(31) Haute-Garonne<br>
										<input class="cbFrFilter" type="checkbox" name="_32" value="_32">(32) Gers<br>
									</div>
									<div class="col-md-4">
										<input class="cbFrFilter" type="checkbox" name="_33" value="_33">(33) Gironde<br>
										<input class="cbFrFilter" type="checkbox" name="_34" value="_34">(34) Hérault<br>
										<input class="cbFrFilter" type="checkbox" name="_35" value="_35">(35) Ille-et-Vilaine<br>
										<input class="cbFrFilter" type="checkbox" name="_36" value="_36">(36) Indre<br>
										<input class="cbFrFilter" type="checkbox" name="_37" value="_37">(37) Indre-et-Loire<br>
										<input class="cbFrFilter" type="checkbox" name="_38" value="_38">(38) Isère<br>
										<input class="cbFrFilter" type="checkbox" name="_39" value="_39">(39) Jura<br>
										<input class="cbFrFilter" type="checkbox" name="_40" value="_40">(40) Landes<br>
										<input class="cbFrFilter" type="checkbox" name="_41" value="_41">(41) Loir-et-Cher<br>
										<input class="cbFrFilter" type="checkbox" name="_42" value="_42">(42) Loire<br>
										<input class="cbFrFilter" type="checkbox" name="_43" value="_43">(43) Haute-Loire<br>
										<input class="cbFrFilter" type="checkbox" name="_44" value="_44">(44) Loire-Atlantique<br>
										<input class="cbFrFilter" type="checkbox" name="_45" value="_45">(45) Loiret<br>
										<input class="cbFrFilter" type="checkbox" name="_46" value="_46">(46) Lot<br>
										<input class="cbFrFilter" type="checkbox" name="_47" value="_47">(47) Lot-et-Garonne<br>
										<input class="cbFrFilter" type="checkbox" name="_48" value="_48">(48) Lozère<br>
										<input class="cbFrFilter" type="checkbox" name="_49" value="_49">(49) Maine-et-Loire<br>
										<input class="cbFrFilter" type="checkbox" name="_50" value="_50">(50) Manche<br>
										<input class="cbFrFilter" type="checkbox" name="_51" value="_51">(51) Marne<br>
										<input class="cbFrFilter" type="checkbox" name="_52" value="_52">(52) Haute-Marne<br>
										<input class="cbFrFilter" type="checkbox" name="_53" value="_53">(53) Mayenne<br>
										<input class="cbFrFilter" type="checkbox" name="_54" value="_54">(54) Meurthe-et-Moselle<br>
										<input class="cbFrFilter" type="checkbox" name="_55" value="_55">(55) Meuse<br>
										<input class="cbFrFilter" type="checkbox" name="_56" value="_56">(56) Morbihan<br>
										<input class="cbFrFilter" type="checkbox" name="_57" value="_57">(57) Moselle<br>
										<input class="cbFrFilter" type="checkbox" name="_58" value="_58">(58) Nièvre<br>
										<input class="cbFrFilter" type="checkbox" name="_59" value="_59">(59) Nord<br>
										<input class="cbFrFilter" type="checkbox" name="_60" value="_60">(60) Oise<br>
										<input class="cbFrFilter" type="checkbox" name="_61" value="_61">(61) Orne<br>
										<input class="cbFrFilter" type="checkbox" name="_62" value="_62">(62) Pas-de-Calais<br>
										<input class="cbFrFilter" type="checkbox" name="_63" value="_63">(63) Puy-de-Dôme<br>
										<input class="cbFrFilter" type="checkbox" name="_64" value="_64">(64) Pyrénées-Atlantiques<br>
									</div>
									<div class="col-md-4">
										<input class="cbFrFilter" type="checkbox" name="_65" value="_65">(65) Hautes-Pyrénées<br>
										<input class="cbFrFilter" type="checkbox" name="_66" value="_66">(66) Pyrénées-Orientales<br>
										<input class="cbFrFilter" type="checkbox" name="_67" value="_67">(67) Bas-Rhin<br>
										<input class="cbFrFilter" type="checkbox" name="_68" value="_68">(68) Haut-Rhin<br>
										<input class="cbFrFilter" type="checkbox" name="_69" value="_69">(69) Rhône<br>
										<input class="cbFrFilter" type="checkbox" name="_70" value="_70">(70) Haute-Saône<br>
										<input class="cbFrFilter" type="checkbox" name="_71" value="_71">(71) Saône-et-Loire<br>
										<input class="cbFrFilter" type="checkbox" name="_72" value="_72">(72) Sarthe<br>
										<input class="cbFrFilter" type="checkbox" name="_73" value="_73">(73) Savoie<br>
										<input class="cbFrFilter" type="checkbox" name="_74" value="_74">(74) Haute-Savoie<br>
										<input class="cbFrFilter" type="checkbox" name="_75" value="_75">(75) Paris<br>
										<input class="cbFrFilter" type="checkbox" name="_76" value="_76">(76) Seine-Maritime<br>
										<input class="cbFrFilter" type="checkbox" name="_77" value="_77">(77) Seine-et-Marne<br>
										<input class="cbFrFilter" type="checkbox" name="_78" value="_78">(78) Yvelines<br>
										<input class="cbFrFilter" type="checkbox" name="_79" value="_79">(79) Deux-Sèvres<br>
										<input class="cbFrFilter" type="checkbox" name="_80" value="_80">(80) Somme<br>
										<input class="cbFrFilter" type="checkbox" name="_81" value="_81">(81) Tarn<br>
										<input class="cbFrFilter" type="checkbox" name="_82" value="_82">(82) Tarn-et-Garonne<br>
										<input class="cbFrFilter" type="checkbox" name="_83" value="_83">(83) Var<br>
										<input class="cbFrFilter" type="checkbox" name="_84" value="_84">(84) Vaucluse<br>
										<input class="cbFrFilter" type="checkbox" name="_85" value="_85">(85) Vendée<br>
										<input class="cbFrFilter" type="checkbox" name="_86" value="_86">(86) Vienne<br>
										<input class="cbFrFilter" type="checkbox" name="_87" value="_87">(87) Haute-Vienne<br>
										<input class="cbFrFilter" type="checkbox" name="_88" value="_88">(88) Vosges<br>
										<input class="cbFrFilter" type="checkbox" name="_89" value="_89">(89) Yonne<br>
										<input class="cbFrFilter" type="checkbox" name="_90" value="_90">(90) Territoire-de-Belfort<br>
										<input class="cbFrFilter" type="checkbox" name="_91" value="_91">(91) Essonne<br>
										<input class="cbFrFilter" type="checkbox" name="_92" value="_92">(92) Hauts-de-Seine<br>
										<input class="cbFrFilter" type="checkbox" name="_93" value="_93">(93) Seine-St-Denis<br>
										<input class="cbFrFilter" type="checkbox" name="_94" value="_94">(94) Val-de-Marne<br>
										<input class="cbFrFilter" type="checkbox" name="_95" value="_95">(95) Val-d'Oise<br>
									</div>
								</div>

							
								<div class="modal-footer">
								<button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
								<button type="button submit" class="btn btn-primary">Valider</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
	{% endif %}

{% endblock %}

{% block javascript %}
	{{ parent() }}
	<script>
		$(".loadTreeIcon").hide();
	</script>
	<!-- FANCY TREE -->
	<script src="{{ asset('js/jquery.fancytree-all.js') }}" type="text/javascript"></script>
	<!-- Initialize the tree when page is loaded -->
	<script src="{{ asset('js/treeApp.js') }}" type="text/javascript"></script>

	<!-- AUTOCOMPLETE -->
	<script src="{{ asset('js/autocomplete.js') }}" type="text/javascript"></script>
	<script>
		$('.searchIcon').hide();
		$('.badge-addon').hide();
		monkeyPatchAutocomplete();
		$('#searchbox').autocomplete({
			source: '{{ url("api_get_syntaxon_search") }}',
			minLength: 3,
			search: function(event, ui) {
				$('.badge-addon').hide();
				$('.searchIcon').show();
			},
			response: function(event, ui) {
				$('.searchIcon').hide();
				$('.badge-addon').text(ui.content.length);
				$('.badge-addon').show();
			},
			focus: function(event, ui) {
		        event.preventDefault();
		    },
		    change: function(event, ui) {
		    	$('.badge-addon').hide();
		    },
		    close: function(event, ui) {
		    	$('.badge-addon').hide();
		    },
			select : function(event, ui){
				event.preventDefault();
				//alert( Routing.generate('api_get_syntaxon_node', { id: ui.item.id }, true) );
				window.location.replace(Routing.generate('eveg_show_one', { id: ui.item.id }, true));
				$('.badge-addon').hide();
			}
		});
	</script>

	<!-- RESIZABLE -->
	<!--
	<script src="{{ asset('js/resizable.js') }}" type="text/javascript"></script>
	<script>
		$("#divTree").resizable({
	        alsoResizeReverse: "#notTree"
	    });
	</script>
	-->

	<!-- EXPAND NODES -->
	<script>
		{% if syntaxon is defined%}
			function expandNodes(){
				$(".loadTreeIcon").show();
				var tree = $("#divTree").fancytree("getTree");
				tree.loadKeyPath("{% if allParents is defined %}{% for parent in allParents %}/{{ parent.id }}{% endfor %}/{{ syntaxon.id}}{% endif %}", function(node, status){
				  
				  if(status === "loaded") {
				    //console.log("loaded intermiediate node " + node);
				  }
				  
				  if(status === "ok") {
				    tree.activateKey("{{ syntaxon.id }}");
				    $(".loadTreeIcon").hide();
				  }


				  //console.debug("node [" + node + "]: " + status)
				});
			}
		{% endif %}
	</script>

	<!-- French departments map -->
	{% javascripts 
		'@evegAppBundle/Resources/public/js/maps/*'
		'js/maps/*' %}
		<script type="text/javascript" src="{{ asset_url }}"></script>
	{% endjavascripts %}

	<script>
		var repDepFr = '{{ repDepFrJson | raw }}';
		createMapDepFr(document.getElementById('mapDepFr'),
			           document.getElementById('mapDepFrHoverLegend'),
			           document.getElementById('mapDepFrLegend'),
			           repDepFr,
			           0.55);
		$("#mapDepFrLegend").hide();
		$("#mapDepFrToggleLegend").click(function(){
			$("#mapDepFrLegend").toggle();
		});
	</script>
	
	<!-- BOOTSTRAP TOOLTIP -->
	<script>
		$(".showTooltip").tooltip({html:true});
		$('[data-tooltip="tooltip"]').tooltip();
	</script>

	<!-- LIMIT THE NUMBER OF VISIBLE ITEMS -->
	<script>
		function limitResults(label, item, click){
			// label : node to be shown / hidden
			// item : node to limit repetition
			// click : click this element to toggle
			$(label).hide();
			var limit = 3;
			var synonymsExpand = false;
			var nbSynonyms = $(item).size();
			var strExpand = 'Afficher tout (' + nbSynonyms + ')';
			var strMini = 'Réduire';
			$(label).html(strExpand);
			//console.log($('.synonymsBox').size());
			if(nbSynonyms >= limit) {
				synonymsExpand = true;
				$(item).slice(limit).hide();
				$(label).show();
			}
			$(click).click(function(){
				if(synonymsExpand == true) {
					$(item).show();
					$(label).html(strMini);
					synonymsExpand = false
				} else {
					$(item).slice(limit).hide();
					$(label).html(strExpand);
					synonymsExpand = true;
				}	
			});	
		}

		limitResults(".synonymsShowAll", ".synonymBox", ".panelSynonymsHeader");
		
	</script>

	<!-- FR DEPARTMENT FILTER -->
	<script>
		var appSessionSF2DepFrFilter = '{{ app.session.get("depFrFilter") | raw }}';
		var depFrFilter;
		if('{{ app.session.get("depFrFilter") | raw }}' != '') {
			depFrFilter = jQuery.parseJSON(appSessionSF2DepFrFilter);
		} else {
			depFrFilter = null;
		}
		for(cb in depFrFilter) {
			$(".cbFrFilter[name="+cb+"]").prop('checked', true);
		}
	</script>

{% endblock %}